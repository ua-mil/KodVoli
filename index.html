<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KodVoli | LiFePO‚ÇÑ Offline OSINT Energy Tool v3.2</title>

  <style>
    :root {
      --bg: #020617;
      --grid: #1e293b;
      --accent: #22d3ee;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --ok: #4ade80;
      --warn: #f87171;
    }
    body {
      margin: 0;
      font-family: Consolas, "Segoe UI", monospace;
      background: radial-gradient(circle at top, #020617, #000);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      padding: 20px;
      border-bottom: 1px solid var(--grid);
      text-align: center;
    }
    header h1 {
      margin: 0;
      color: var(--accent);
      font-size: 24px;
    }
    header span {
      color: var(--muted);
      font-size: 13px;
      display: block;
      margin-top: 5px;
    }
    .panel {
      max-width: 1100px;
      margin: 20px auto;
      padding: 0 20px;
      flex: 1;
    }
    .section {
      border: 1px solid var(--grid);
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      background: rgba(30, 41, 59, 0.3);
    }
    .section h2 {
      margin: 0 0 12px 0;
      color: var(--accent);
      font-size: 18px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid var(--grid);
      padding: 10px;
      text-align: left;
      vertical-align: middle;
    }
    th {
      color: var(--muted);
      font-weight: normal;
      background: rgba(0, 0, 0, 0.3);
    }
    input, select {
      width: 100%;
      padding: 8px;
      background: #000;
      border: 1px solid var(--grid);
      color: var(--text);
      box-sizing: border-box;
      border-radius: 4px;
    }
    select {
      height: 40px;
    }
    .result {
      background: #000;
      font-weight: bold;
    }
    .ok {
      color: var(--ok);
    }
    .warn {
      color: var(--warn);
    }
    button {
      padding: 10px 20px;
      background: var(--accent);
      color: #000;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
      transition: background 0.3s;
    }
    button:hover {
      background: #67e8f9;
    }
    #copyNotification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--ok);
      color: #000;
      padding: 12px 24px;
      border-radius: 6px;
      font-weight: bold;
      opacity: 0;
      transition: opacity 0.4s;
      pointer-events: none;
    }
    footer {
      text-align: center;
      color: var(--muted);
      font-size: 12px;
      padding: 15px;
      border-top: 1px solid var(--grid);
      margin-top: auto;
    }
  </style>
</head>

<body>

  <header>
    <h1>KodVoli Offline OSINT Energy Tool v3.2</h1>
    <span>LiFePO‚ÇÑ ‚Ä¢ –Ü–Ω–≤–µ—Ä—Ç–æ—Ä–∏ ‚Ä¢ –ü–æ–≤–Ω–∞ DC-–∞–Ω–∞–ª—ñ—Ç–∏–∫–∞</span>
  </header>

  <div class="panel">

    <!-- –°–ò–°–¢–ï–ú–ê -->
    <div class="section">
      <h2>‚öôÔ∏è –°–∏—Å—Ç–µ–º–∞</h2>
      <table>
        <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–ó–Ω–∞—á–µ–Ω–Ω—è</th><th>–û–¥–∏–Ω–∏—Ü—è</th></tr>
        <tr>
          <td>–ù–æ–º—ñ–Ω–∞–ª—å–Ω–∞ DC —Å–∏—Å—Ç–µ–º–∞</td>
          <td>
            <select id="systemV">
              <option value="12">12</option>
              <option value="24">24</option>
              <option value="48" selected>48</option>
            </select>
          </td>
          <td>V</td>
        </tr>
      </table>
    </div>

    <!-- –ê–ö–ë -->
    <div class="section">
      <h2>üîã –ê–∫—É–º—É–ª—è—Ç–æ—Ä LiFePO‚ÇÑ</h2>
      <table>
        <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–ó–Ω–∞—á–µ–Ω–Ω—è</th><th>–û–¥–∏–Ω–∏—Ü—è</th></tr>
        <tr><td>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ (S)</td><td id="cells">-</td><td>—à—Ç</td></tr>
        <tr><td>–Ñ–º–Ω—ñ—Å—Ç—å</td><td><input id="Ah" type="number" min="1" step="1" value="100"></td><td>Ah</td></tr>
        <tr><td>–ù–æ–º—ñ–Ω–∞–ª—å–Ω–∞ –Ω–∞–ø—Ä—É–≥–∞ –µ–ª–µ–º–µ–Ω—Ç–∞</td><td><input id="Vcell" type="number" min="0" step="0.01" value="3.2"></td><td>V</td></tr>
        <tr><td>–ú–∞–∫—Å. –Ω–∞–ø—Ä—É–≥–∞ –µ–ª–µ–º–µ–Ω—Ç–∞</td><td><input id="VcellMax" type="number" min="0" step="0.01" value="3.65"></td><td>V</td></tr>
        <tr><td>–ú—ñ–Ω. –Ω–∞–ø—Ä—É–≥–∞ –µ–ª–µ–º–µ–Ω—Ç–∞</td><td><input id="VcellMin" type="number" min="0" step="0.01" value="2.5"></td><td>V</td></tr>
        <tr><td>DoD (–≥–ª–∏–±–∏–Ω–∞ —Ä–æ–∑—Ä—è–¥—É)</td><td><input id="DoD" type="number" min="0" max="100" step="1" value="80"></td><td>%</td></tr>
      </table>
    </div>

    <!-- –Ü–ù–í–ï–†–¢–û–† -->
    <div class="section">
      <h2>‚ö° –Ü–Ω–≤–µ—Ä—Ç–æ—Ä</h2>
      <table>
        <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–ó–Ω–∞—á–µ–Ω–Ω—è</th><th>–û–¥–∏–Ω–∏—Ü—è</th></tr>
        <tr><td>–ö–ö–î —ñ–Ω–≤–µ—Ä—Ç–æ—Ä–∞</td><td><input id="eff" type="number" min="50" max="99" step="1" value="93"></td><td>%</td></tr>
      </table>
    </div>

    <!-- –ù–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø -->
    <div class="section">
      <h2>üîå –ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –∫–∞–±–µ–ª—å</h2>
      <table>
        <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–ó–Ω–∞—á–µ–Ω–Ω—è</th><th>–û–¥–∏–Ω–∏—Ü—è</th></tr>
        <tr><td>–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</td><td><input id="loadW" type="number" min="0" step="10" value="3000"></td><td>W</td></tr>
        <tr><td>–î–æ–≤–∂–∏–Ω–∞ –∫–∞–±–µ–ª—é (–æ–¥–∏–Ω –±—ñ–∫)</td><td><input id="length" type="number" min="0" step="0.1" value="2"></td><td>–º</td></tr>
      </table>
    </div>

    <!-- –ê–ù–ê–õ–Ü–¢–ò–ö–ê -->
    <div class="section">
      <h2>üìä –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞</h2>
      <table>
        <tr class="result"><td>–ù–æ–º—ñ–Ω–∞–ª—å–Ω–∞ –Ω–∞–ø—Ä—É–≥–∞ –ê–ö–ë</td><td id="Vnom">-</td><td>V</td></tr>
        <tr class="result"><td>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –Ω–∞–ø—Ä—É–≥–∞ –ê–ö–ë</td><td id="Vmax">-</td><td>V</td></tr>
        <tr class="result"><td>–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –Ω–∞–ø—Ä—É–≥–∞ –ê–ö–ë</td><td id="Vmin">-</td><td>V</td></tr>
        <tr class="result"><td>–ü–æ–≤–Ω–∞ –µ–Ω–µ—Ä–≥—ñ—è –ê–ö–ë</td><td id="Efull">-</td><td>Wh</td></tr>
        <tr class="result"><td>–î–æ—Å—Ç—É–ø–Ω–∞ –µ–Ω–µ—Ä–≥—ñ—è (–∑ –ö–ö–î)</td><td id="Euse">-</td><td>Wh</td></tr>
        <tr class="result"><td>DC —Å—Ç—Ä—É–º –≤—ñ–¥ –ê–ö–ë</td><td id="Idc">-</td><td>A</td></tr>
        <tr class="result"><td>–ß–∞—Å –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—ó —Ä–æ–±–æ—Ç–∏</td><td id="time">-</td><td>–≥–æ–¥</td></tr>
        <tr class="result"><td>–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π –ø–µ—Ä–µ—Ç–∏–Ω –∫–∞–±–µ–ª—é</td><td id="cable">-</td><td>–º–º¬≤</td></tr>
        <tr class="result"><td>–ü–∞–¥—ñ–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏ –Ω–∞ –∫–∞–±–µ–ª—ñ</td><td id="drop">-</td><td>%</td></tr>
        <tr><td>–û—Ü—ñ–Ω–∫–∞ —Å–∏—Å—Ç–µ–º–∏</td><td id="warn">-</td><td></td></tr>
      </table>

      <button id="copyBtn">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏</button>
    </div>

  </div>

  <div id="copyNotification">–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!</div>

  <footer>
    KodVoli ¬© Offline OSINT Energy Tool ‚Ä¢ ŒîV ‚â§ 2‚Äì3% ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∞ —ñ–Ω–∂–µ–Ω–µ—Ä–Ω–∞ –Ω–æ—Ä–º–∞
  </footer>

  <script>
    // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
    const systemV   = document.getElementById('systemV');
    const cells     = document.getElementById('cells');
    const Ah        = document.getElementById('Ah');
    const Vcell     = document.getElementById('Vcell');
    const VcellMax  = document.getElementById('VcellMax');
    const VcellMin  = document.getElementById('VcellMin');
    const DoD       = document.getElementById('DoD');
    const eff       = document.getElementById('eff');
    const loadW     = document.getElementById('loadW');
    const length    = document.getElementById('length');

    const Vnom      = document.getElementById('Vnom');
    const Vmax      = document.getElementById('Vmax');
    const Vmin      = document.getElementById('Vmin');
    const Efull     = document.getElementById('Efull');
    const Euse      = document.getElementById('Euse');
    const Idc       = document.getElementById('Idc');
    const time      = document.getElementById('time');
    const cable     = document.getElementById('cable');
    const drop      = document.getElementById('drop');
    const warn      = document.getElementById('warn');
    const copyBtn   = document.getElementById('copyBtn');
    const notification = document.getElementById('copyNotification');

    const RHO_CU = 0.0175;

    function seriesCount(V) {
      if (V === 12) return 4;
      if (V === 24) return 8;
      if (V === 48) return 16;
      return Math.round(V / 3.2);
    }

    function recommendCable(I) {
      if (I <= 25) return 6;
      if (I <= 40) return 10;
      if (I <= 63) return 16;
      if (I <= 80) return 25;
      if (I <= 125) return 35;
      if (I <= 160) return 50;
      return 70;
    }

    function calculate() {
      const Vsys = parseFloat(systemV.value) || 48;
      const S = seriesCount(Vsys);
      cells.textContent = S;

      const capacity = parseFloat(Ah.value) || 100;
      const vCell = parseFloat(Vcell.value) || 3.2;
      const vCellMax = parseFloat(VcellMax.value) || 3.65;
      const vCellMin = parseFloat(VcellMin.value) || 2.5;
      const dod = (parseFloat(DoD.value) || 80) / 100;
      const efficiency = (parseFloat(eff.value) || 93) / 100;
      const load = parseFloat(loadW.value) || 3000;
      const len = parseFloat(length.value) || 2;

      const vNom = S * vCell;
      const vMax = S * vCellMax;
      const vMin = S * vCellMin;

      const energyFull = vNom * capacity;
      const energyUse = energyFull * dod * efficiency;

      const currentDC = load / Vsys;
      const runtime = load > 0 ? energyUse / load : 0;

      const cableArea = recommendCable(currentDC);
      const voltageDrop = cableArea > 0 ? (2 * len * currentDC * RHO_CU / cableArea) / Vsys * 100 : 0;

      let warning = "–†–µ–∂–∏–º —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π";
      if (currentDC > 120) {
        warning = "–ö—Ä–∏—Ç–∏—á–Ω–∏–π DC —Å—Ç—Ä—É–º (>120 A) ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä BMS, –∫–æ–Ω—Ç–∞–∫—Ç–∏ —Ç–∞ –∑–∞–ø–æ–±—ñ–∂–Ω–∏–∫–∏!";
      } else if (voltageDrop > 3) {
        warning = "–ü–∞–¥—ñ–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏ > 3% ‚Äî –∑–±—ñ–ª—å—à—ñ—Ç—å –ø–µ—Ä–µ—Ç–∏–Ω –∫–∞–±–µ–ª—é!";
      } else if (voltageDrop > 2) {
        warning = "–ü–∞–¥—ñ–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏ 2‚Äì3% ‚Äî –±–∞–∂–∞–Ω–æ –∑–±—ñ–ª—å—à–∏—Ç–∏ –ø–µ—Ä–µ—Ç–∏–Ω";
      }

      Vnom.textContent = vNom.toFixed(2);
      Vmax.textContent = vMax.toFixed(2);
      Vmin.textContent = vMin.toFixed(2);
      Efull.textContent = Math.round(energyFull);
      Euse.textContent = Math.round(energyUse);
      Idc.textContent = currentDC.toFixed(1);
      time.textContent = runtime.toFixed(2);
      cable.textContent = cableArea + " –º–º¬≤";
      drop.textContent = voltageDrop.toFixed(2);
      warn.innerHTML = warning.indexOf('–ö—Ä–∏—Ç–∏—á–Ω–∏–π') > -1 || voltageDrop > 2 ? 
        `<span class='warn'>${warning}</span>` : 
        `<span class='ok'>${warning}</span>`;
    }

    // –ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
    copyBtn.addEventListener('click', () => {
      const text = `
KodVoli Offline OSINT Energy Tool v3.2 ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

–ù–æ–º—ñ–Ω–∞–ª—å–Ω–∞ –Ω–∞–ø—Ä—É–≥–∞ –ê–ö–ë: ${Vnom.textContent} V
–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –Ω–∞–ø—Ä—É–≥–∞ –ê–ö–ë: ${Vmax.textContent} V
–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –Ω–∞–ø—Ä—É–≥–∞ –ê–ö–ë: ${Vmin.textContent} V
–ü–æ–≤–Ω–∞ –µ–Ω–µ—Ä–≥—ñ—è –ê–ö–ë: ${Efull.textContent} Wh
–î–æ—Å—Ç—É–ø–Ω–∞ –µ–Ω–µ—Ä–≥—ñ—è (–∑ –ö–ö–î): ${Euse.textContent} Wh
DC —Å—Ç—Ä—É–º –≤—ñ–¥ –ê–ö–ë: ${Idc.textContent} A
–ß–∞—Å –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—ó —Ä–æ–±–æ—Ç–∏: ${time.textContent} –≥–æ–¥
–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π –ø–µ—Ä–µ—Ç–∏–Ω –∫–∞–±–µ–ª—é: ${cable.textContent}
–ü–∞–¥—ñ–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏ –Ω–∞ –∫–∞–±–µ–ª—ñ: ${drop.textContent} %
–û—Ü—ñ–Ω–∫–∞ —Å–∏—Å—Ç–µ–º–∏: ${warn.textContent}

–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É:
- –°–∏—Å—Ç–µ–º–∞: \( {systemV.value} V ( \){cells.textContent} –µ–ª–µ–º–µ–Ω—Ç—ñ–≤)
- –Ñ–º–Ω—ñ—Å—Ç—å: ${Ah.value} Ah
- DoD: ${DoD.value} %
- –ö–ö–î —ñ–Ω–≤–µ—Ä—Ç–æ—Ä–∞: ${eff.value} %
- –ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: ${loadW.value} W
- –î–æ–≤–∂–∏–Ω–∞ –∫–∞–±–µ–ª—é (–æ–¥–∏–Ω –±—ñ–∫): ${length.value} –º
      `.trim();

      navigator.clipboard.writeText(text).then(() => {
        notification.style.opacity = 1;
        setTimeout(() => { notification.style.opacity = 0; }, 2000);
      }).catch(() => {
        alert('–ù–µ –≤–¥–∞–ª–æ—Å—è —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ (–º–æ–∂–ª–∏–≤–æ, —á–µ—Ä–µ–∑ —Å—Ç–∞—Ä–∏–π –±—Ä–∞—É–∑–µ—Ä)');
      });
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    document.querySelectorAll('input, select').forEach(el => {
      el.addEventListener('input', calculate);
    });

    // –ü–µ—Ä–≤—ã–π —Ä–∞—Å—á—ë—Ç
    calculate();
  </script>

</body>
</html>